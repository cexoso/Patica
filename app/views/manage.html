<section class="container-fluid">
    <article style="min-height: 86.5vh;">
        <div class="panel panel-default">
            <div class="panel-heading">订单列表&gt;所有订单</div>
        </div>
        <div ng-controller="funCtroller">
            <div class="btn-group" style="margin-bottom: 30px;">
                <button type="button" class="btn btn-default btn-sm" ng-click="appendBill()">手动录单</button>
                <button type="button" class="btn btn-default btn-sm" ng-click="appendPeople()">添加负责人</button>
                <a target="download" ng-href="api/download?ordertime={{filter.starttime|date:'yyyy-MM-dd'}}" class="btn btn-default btn-sm">下载</a>
            </div>
            <form class="form-horizontal">
                <div class="form-group">
                    <div class="col-sm-3">
                        <div class="input-group">
                            <label class="control-label input-group-addon">订单号</label>
                            <input type="text" class='form-control' ng-model="filter.orderid"></div>
                    </div>
                    <div class="col-sm-3">
                        <div class="input-group">
                            <label class="control-label input-group-addon">城市</label>
                            <select  class='form-control' ng-model="filter.city" ng-options="city.cityName as city.cityName for city in filters.citys">
                                <option value=""></option>
                            </select>
                        </div>

                    </div>
                    <div class="col-sm-3">
                        <div class="input-group">
                            <label class="control-label input-group-addon">订单类型</label>
                            <select  class='form-control' ng-model="filter.ordertype" ng-options="orderTypes.id as orderTypes.name for orderTypes in filters.orderTypes">
                                <option value=""></option>
                            </select>
                        </div>
                    </div>
                    <!-- <div class="col-sm-3">
                    <div class="input-group">
                        <label class="control-label input-group-addon">支付状态</label>
                        <select  class='form-control' ng-model="filter.pay_status" ng-options="payStatus.id as payStatus.name for payStatus in filters.payStatus">
                            <option value=""></option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-3">
                    <div class="input-group">
                        <label class="control-label input-group-addon">金额</label>
                        <input type="text" class='form-control' ng-model="filter.price"></div>
                </div>
                -->
            </div>
            <div class="form-group">
                <div class="col-sm-3">
                    <div class="input-group">
                        <label class="control-label input-group-addon">用户名</label>
                        <input type="text" class='form-control' ng-model="filter.username"></div>
                </div>
                <div class="col-sm-3">
                    <div class="input-group">
                        <label class="control-label input-group-addon">用户电话</label>
                        <input type="text" class='form-control' ng-model="filter.phone"></div>
                </div>
                <!-- <div class="col-sm-3">
                <div class="input-group">
                    <label class="control-label input-group-addon">订单来源</label>
                    <select  class='form-control' ng-model="filter.ordersource" ng-options="ordersource.id as ordersource.name for ordersource in filters.ordersources">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            -->
        </div>
        <div class="form-group" ng-controller="DatepickerDemoCtrl">
            <div class="col-sm-3">
                <div class="input-group">
                    <label class="control-label input-group-addon">开始时间</label>
                    <input type="date" show-weeks="false" class="form-control" current-text='今天' clear-text='清除' datepicker-popup ng-model="filter.starttime" is-open="status.startOpened" max-date="filter.endtime" datepicker-options="dateOptions" close-text="关闭" />
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="startOpen($event)"> <i class="glyphicon glyphicon-calendar"></i>
                        </button>
                    </span>
                </div>
            </div>
            <div class="col-sm-3">
                <div class="input-group">
                    <label class="control-label input-group-addon">结束时间</label>
                    <input type="date" show-weeks="false" class="form-control" current-text='今天' clear-text='清除' datepicker-popup ng-model="filter.endtime" is-open="status.endOpened" min-date="filter.starttime" datepicker-options="dateOptions" close-text="关闭" />
                    <span class="input-group-btn">
                        <button type="button" class="btn btn-default" ng-click="endOpen($event)"> <i class="glyphicon glyphicon-calendar"></i>
                        </button>
                    </span>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-12">
                <button style="width:100%" class='btn-lg btn btn-success' ng-click="query()">{{tips.btn}}</button>
            </div>
        </div>
    </form>
    <table class="table table-hover table-bordered table-striped">
        <thead>
            <tr style="background-color: orange;">
                <th class="text-nowrap">#</th>
                <th class="text-nowrap">订单号</th>
                <th class="text-nowrap">下单信息</th>
                <th class="text-nowrap">用户信息</th>
                <th class="text-nowrap">报价</th>
                <th class="text-nowrap">订单状态</th>
                <th class="text-nowrap">备注</th>

                <th class="text-nowrap">操作</th>
                <!-- <th class="text-nowrap">付款方式</th>
            <th class="text-nowrap">负责人</th>
            <th class="text-nowrap">客户来源</th>
            <th class="text-nowrap">IMEI</th>
            <th class="text-nowrap">券号</th>
            <th class="text-nowrap">备注</th>
            -->
        </tr>
    </thead>
    <tbody>
        <tr ng-repeat="order in page.orders">
            <td style="vertical-align: middle">{{$index+1}}</td>
            <td>
                <div class="table-cell text-wrap">
                    <div class="cell-item">
                        <label class="manageLabel">订单号:</label>
                        {{order.orderid}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">订单来源:</label>
                        {{order.ordersource|ordersourceParse}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">IMEI:</label>
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">服务单号:</label>
                    </div>

                </div>
            </td>
            <td>
                <div class="table-cell text-wrap">
                    <div class="cell-item">
                        <label class="manageLabel">下单时间:</label>
                        {{order.ordertime|date:'yyyy-MM-dd'}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">品牌:</label>
                        {{order.brandName}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">型号:</label>
                        {{order.colorName}}-{{order.modelName}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">故障:</label>
                        {{order.trouble_desc}}
                    </div>
                </div>
            </td>
            <td>
                <div class="table-cell text-wrap">
                    <div class="cell-item">
                        <label class="manageLabel">姓名:</label>
                        {{order.user_real_name}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">电话:</label>
                        {{order.user_phone}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">地址:</label>
                        {{order.user_city}} {{order.user_area}} {{order.address_desc}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">预约时间:</label>
                        {{order.user_repair_date*1000|date:'yyyy-MM-dd'}} {{order.user_repair_time_slot}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">订单类型:</label>
                        {{order.order_type|orderTypeParse}}
                    </div>
                </div>
            </td>

            <td>
                <div class="table-cell text-wrap">
                    <div class="cell-item">
                        <label class="manageLabel">系统报价:</label>
                        {{order.total_price}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">折扣:</label>
                        {{order.discount_price}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">实付:</label>
                        {{order.actual_price}}
                    </div>
                </div>
            </td>
            <td style="word-break: break-all;max-width:12em">
                <div class="table-cell text-wrap">
                    <div class="cell-item">
                        <label class="manageLabel">订单状态:</label>
                        {{order.status|statusParse}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">状态修改时间:</label>
                        {{order.status_time|date:'yyyy-MM-dd'}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">负责人:</label>
                        {{order.engineerName}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">星:</label>
                        {{order.evaluate_star}}
                    </div>

                    <div class="cell-item">
                        <label class="manageLabel">标签:</label>
                        {{order.evaluate_tags|evaluate_tagsParse}}
                    </div>
                    <div class="cell-item">
                        <label class="manageLabel">评价:</label>
                        {{order.evaluate}}
                    </div>
                </div>
            </td>
            <td style="word-break: break-all;max-width:12em">
                <div class="cell-item">
                    <label class="manageLabel">客户备注:</label>
                    <div>{{order.userComment}}</div>
                </div>
                <div class="cell-item">
                    <label class="manageLabel">客服备注:</label>
                    <div>{{order.remark}}</div>
                </div>
            </td>
            <td class="vertical-middle">
                <div style="width:100px" class="btn-group-vertical">
                    <button class="btn btn-default" ng-click="assign(order)">派单</button>
                    <button class="btn btn-default" ng-click="alter(order)">修改</button>
                </div>
            </td>
        </tr>
    </tbody>
</table>
</div>
</article>
<footer>
<div style="position:relative;min-height:75px;">
<div class="position-center">
    <pagination ng-change="pageChanged(page.page)" total-items="page.totalcount" items-per-page="page.pagesize" ng-model="page.page" max-size="10" class="pagination-sm" boundary-links="true" rotate="false"></pagination>
</div>
</div>
<pre class="text-center">Page: {{page.page}} / {{page.numPages}}</pre>
</footer>
</section>